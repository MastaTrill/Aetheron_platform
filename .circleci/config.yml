version: 2.1
jobs:
  build:
    docker:
      - image: cimg/node:18.17
    steps:
      - checkout
      - run:
          name: Install Node.js dependencies
          command: npm ci
      - run:
          name: Run linting
          command: npm run lint || echo "No lint script defined"
      - run:
          name: Check for build script
          command: |
            if npm run | grep -q "build"; then
              npm run build
            else
              echo "No build script found - static site detected"
            fi
      - run:
          name: Run tests
          command: |
            if npm run | grep -q "test"; then
              npm test
            else
              echo "No test script found"
            fi
workflows:
  build_and_test:
    jobs:
      - build
