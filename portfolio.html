<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <meta http-equiv="Content-Security-Policy"
    content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://unpkg.com https://www.googletagmanager.com https://www.google-analytics.com; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://fonts.googleapis.com; img-src 'self' data: https:; font-src 'self' https://cdnjs.cloudflare.com https://fonts.gstatic.com; connect-src 'self' https://api.coingecko.com https://api.coinmarketcap.com https://polygon-rpc.com https://rpc-mainnet.matic.network https://etherscan.io https://api.etherscan.io https://api.polygonscan.com https://polygonscan.com https://api.dexscreener.com https://dexscreener.com https://api.github.com https://github.com https://api.telegram.org https://telegram.org https://discord.com https://discordapp.com https://api.discord.com https://cdn.discordapp.com; frame-src 'self' https://www.youtube.com https://youtube.com https://player.vimeo.com https://vimeo.com;">
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  <title>Portfolio Tracker - Aetheron Platform</title>
  <link rel="stylesheet" href="dashboard.css">
  <link rel="stylesheet" href="mobile-optimization.css">
  <link rel="stylesheet" href="shared-mobile-polish.css?v=1.3.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
  <nav class="main-nav">
    <div class="nav-container">
      <div class="nav-brand">
        <h1>AETHERON</h1>
      </div>
      <div class="nav-links"><a href="index.html"><i class="fas fa-home"></i> Dashboard</a> <a
          href="analytics-dashboard.html"><i class="fas fa-chart-bar"></i> Analytics</a> <a
          href="staking-calculator.html"><i class="fas fa-calculator"></i> Calculator</a> <a href="price-alerts.html"><i
            class="fas fa-bell"></i> Alerts</a> <a href="portfolio.html" class="active"><i class="fas fa-wallet"></i>
          Portfolio</a></div>
    </div>
  </nav>
  <main class="main-content">
    <div class="container">
      <div class="page-header">
        <h1><i class="fas fa-wallet"></i> Portfolio Tracker</h1>
        <p>Track your AETH holdings, staking positions, and rewards</p>
      </div>
      <div class="wallet-status-card card" id="walletStatus"><button class="btn-primary btn-lg"
          onclick="connectWallet()"><i class="fas fa-wallet"></i> Connect Wallet</button></div>
      <div id="portfolioContent" class="hidden">
        <div class="portfolio-summary">
          <div class="summary-card card">
            <div class="card-icon card-icon-blue"><i class="fas fa-chart-line"></i></div>
            <div class="card-details"><span class="card-label">Total Portfolio Value</span> <span class="card-value"
                id="totalValue">$0.00</span> <span class="card-change" id="totalChange">--</span></div>
          </div>
          <div class="summary-card card">
            <div class="card-icon card-icon-pink"><i class="fas fa-coins"></i></div>
            <div class="card-details"><span class="card-label">Total AETH Balance</span> <span class="card-value"
                id="totalAETH">0 AETH</span> <span class="card-change" id="aethUSD">$0.00</span></div>
          </div>
          <div class="summary-card card">
            <div class="card-icon card-icon-cyan"><i class="fas fa-lock"></i></div>
            <div class="card-details"><span class="card-label">Staked AETH</span> <span class="card-value"
                id="stakedAETH">0 AETH</span> <span class="card-change" id="stakedUSD">$0.00</span></div>
          </div>
          <div class="summary-card card">
            <div class="card-icon card-icon-green"><i class="fas fa-gift"></i></div>
            <div class="card-details"><span class="card-label">Total Rewards Earned</span> <span class="card-value"
                id="totalRewards">0 AETH</span> <span class="card-change" id="rewardsUSD">$0.00</span></div>
          </div>
        </div>
        <div class="section">
          <h2><i class="fas fa-layer-group"></i> Asset Breakdown</h2>
          <div class="asset-grid">
            <div class="asset-card card">
              <h3><i class="fas fa-wallet"></i> Wallet Balance</h3>
              <div class="asset-amount" id="walletBalance">0 AETH</div>
              <div class="asset-value" id="walletValue">$0.00</div>
              <div class="asset-percentage" id="walletPercentage">0%</div>
            </div>
            <div class="asset-card card">
              <h3><i class="fas fa-lock"></i> Staked (Pool 1)</h3>
              <div class="asset-amount" id="staked1">0 AETH</div>
              <div class="asset-value" id="staked1Value">$0.00</div>
              <div class="asset-percentage" id="staked1Percentage">0%</div>
            </div>
            <div class="asset-card card">
              <h3><i class="fas fa-lock"></i> Staked (Pool 2)</h3>
              <div class="asset-amount" id="staked2">0 AETH</div>
              <div class="asset-value" id="staked2Value">$0.00</div>
              <div class="asset-percentage" id="staked2Percentage">0%</div>
            </div>
            <div class="asset-card card">
              <h3><i class="fas fa-lock"></i> Staked (Pool 3)</h3>
              <div class="asset-amount" id="staked3">0 AETH</div>
              <div class="asset-value" id="staked3Value">$0.00</div>
              <div class="asset-percentage" id="staked3Percentage">0%</div>
            </div>
          </div>
        </div>
        <div class="section">
          <h2><i class="fas fa-chart-pie"></i> Active Staking Positions</h2>
          <div class="stakes-table card">
            <table>
              <thead>
                <tr>
                  <th>Pool</th>
                  <th>Amount Staked</th>
                  <th>APY</th>
                  <th>Rewards Earned</th>
                  <th>Est. Rewards</th>
                  <th>Lock Period</th>
                  <th>Unlock Date</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody id="stakesTableBody">
                <tr>
                  <td colspan="8" class="empty-state"><i class="fas fa-inbox empty-state-icon"></i> No active staking
                    positions</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="section">
          <h2><i class="fas fa-chart-line"></i> Performance Metrics</h2>
          <div class="metrics-grid">
            <div class="metric-card card">
              <div class="metric-label">Average APY</div>
              <div class="metric-value" id="avgAPY">0%</div>
            </div>
            <div class="metric-card card">
              <div class="metric-label">Daily Earnings</div>
              <div class="metric-value" id="dailyEarnings">0 AETH</div>
            </div>
            <div class="metric-card card">
              <div class="metric-label">Monthly Earnings (Est.)</div>
              <div class="metric-value" id="monthlyEarnings">0 AETH</div>
            </div>
            <div class="metric-card card">
              <div class="metric-label">Yearly Earnings (Est.)</div>
              <div class="metric-value" id="yearlyEarnings">0 AETH</div>
            </div>
            <div class="metric-card card">
              <div class="metric-label">ROI Since Start</div>
              <div class="metric-value" id="roi">0%</div>
            </div>
            <div class="metric-card card">
              <div class="metric-label">Days Staking</div>
              <div class="metric-value" id="daysStaking">0</div>
            </div>
          </div>
        </div>
        <div class="section">
          <div class="info-box">
            <h3><i class="fas fa-history"></i> Need More Details?</h3>
            <p>View your complete transaction history, including all stakes, unstakes, and reward claims.</p><a
              href="transaction-history.html" class="btn-secondary"><i class="fas fa-list"></i> View Transaction
              History</a>
          </div>
        </div>
      </div>
    </div>
  </main>
  <style>
    .portfolio-summary {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 32px
    }

    .summary-card {
      display: flex;
      gap: 16px;
      align-items: center;
      padding: 20px
    }

    .card-icon {
      width: 60px;
      height: 60px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 28px;
      color: #fff
    }

    .card-icon-blue {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .card-icon-pink {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    }

    .card-icon-cyan {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    }

    .card-icon-green {
      background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
    }

    .hidden {
      display: none;
    }

    .empty-state-icon {
      font-size: 48px;
      opacity: 0.5;
      display: block;
      margin-bottom: 16px;
    }

    .card-details {
      display: flex;
      flex-direction: column;
      gap: 4px
    }

    .card-label {
      font-size: 14px;
      color: var(--text-muted)
    }

    .card-value {
      font-size: 24px;
      font-weight: 700;
      color: var(--text-primary)
    }

    .card-change {
      font-size: 14px;
      color: var(--text-secondary)
    }

    .asset-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px
    }

    .asset-card {
      padding: 20px;
      text-align: center
    }

    .asset-card h3 {
      font-size: 14px;
      color: var(--text-muted);
      margin-bottom: 12px
    }

    .asset-amount {
      font-size: 20px;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 4px
    }

    .asset-value {
      font-size: 16px;
      color: var(--text-secondary);
      margin-bottom: 8px
    }

    .asset-percentage {
      font-size: 14px;
      color: var(--accent-blue);
      font-weight: 500
    }

    .stakes-table table {
      width: 100%;
      border-collapse: collapse
    }

    .stakes-table th {
      background: var(--bg-hover);
      padding: 12px;
      text-align: left;
      font-weight: 600;
      border-bottom: 2px solid var(--border-color)
    }

    .stakes-table td {
      padding: 16px 12px;
      border-bottom: 1px solid var(--border-color)
    }

    .badge {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600
    }

    .badge-success {
      background: rgba(52, 168, 83, .1);
      color: var(--accent-green)
    }

    .badge-warning {
      background: rgba(251, 188, 4, .1);
      color: var(--accent-orange)
    }

    .metrics-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 16px
    }

    .metric-card {
      padding: 20px;
      text-align: center
    }

    .metric-label {
      font-size: 13px;
      color: var(--text-muted);
      margin-bottom: 8px
    }

    .metric-value {
      font-size: 22px;
      font-weight: 700;
      color: var(--accent-blue)
    }

    @media (max-width:768px) {
      .stakes-table {
        overflow-x: auto
      }

      .stakes-table table {
        min-width: 800px
      }

      .portfolio-summary {
        grid-template-columns: 1fr
      }
    }
  </style>
  <script>"serviceWorker" in navigator && window.addEventListener("load", () => { navigator.serviceWorker.register("/service-worker.js").then(e => { console.log("ServiceWorker registered:", e.scope), setInterval(() => { e.update() }, 6e4), e.addEventListener("updatefound", () => { const r = e.installing; r.addEventListener("statechange", () => { "activated" === r.state && navigator.serviceWorker.controller && (console.log("New service worker activated, reloading..."), setTimeout(() => window.location.reload(), 2e3)) }) }) }).catch(e => console.log("ServiceWorker registration failed:", e)) }), window.addEventListener("pageshow", e => { e.persisted && window.location.reload() })</script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <script>let provider, signer, userAddress, tokenContract, stakingContract, aethPrice = 487e-6; const TOKEN_ADDRESS = "0xAb5ae0D8f569d7c2B27574319b864a5bA6F9671e", STAKING_ADDRESS = "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb", TOKEN_ABI = ["function balanceOf(address owner) view returns (uint256)", "function decimals() view returns (uint8)", "function symbol() view returns (string)"], STAKING_ABI = ["function userStakes(address user, uint256 poolId) view returns (uint256 amount, uint256 stakeTime, uint256 unlockTime)", "function calculateReward(address user, uint256 poolId) view returns (uint256)", "function poolCount() view returns (uint256)"]; async function connectWallet() { try { if (void 0 === window.ethereum) return void alert("Please install MetaMask to use this feature!"); await window.ethereum.request({ method: "eth_requestAccounts" }), provider = new ethers.providers.Web3Provider(window.ethereum), signer = provider.getSigner(), userAddress = await signer.getAddress(); if (137 !== (await provider.getNetwork()).chainId) { alert("Please switch to Polygon Mainnet (Chain ID: 137)"); try { return await window.ethereum.request({ method: "wallet_switchEthereumChain", params: [{ chainId: "0x89" }] }), void location.reload() } catch (t) { return void console.error("Failed to switch network:", t) } } tokenContract = new ethers.Contract(TOKEN_ADDRESS, TOKEN_ABI, provider), stakingContract = new ethers.Contract(STAKING_ADDRESS, STAKING_ABI, provider), document.getElementById("walletStatus").style.display = "none", document.getElementById("portfolioContent").style.display = "block", await loadPortfolioData() } catch (t) { console.error("Error connecting wallet:", t), alert("Failed to connect wallet. Please try again.") } } async function fetchAethPrice() { try { const t = await fetch("https://api.dexscreener.com/latest/dex/pairs/polygon/0xd57c5E33ebDC1b565F99d06809debbf86142705D"), e = await t.json(); e.pair && e.pair.priceUsd && (aethPrice = parseFloat(e.pair.priceUsd)) } catch (t) { console.log("Failed to fetch price, using default:", t) } } async function loadPortfolioData() { try { await fetchAethPrice(); const t = await tokenContract.balanceOf(userAddress), e = await tokenContract.decimals(), n = parseFloat(ethers.utils.formatUnits(t, e)); let o = 0, a = 0; const d = [], r = [{ id: 0, apy: 5, days: 30, name: "30-Day Pool (5% APY)" }, { id: 1, apy: 12, days: 90, name: "90-Day Pool (12% APY)" }, { id: 2, apy: 25, days: 180, name: "180-Day Pool (25% APY)" }]; for (const t of r) try { const n = await stakingContract.userStakes(userAddress, t.id), r = parseFloat(ethers.utils.formatUnits(n.amount, e)); if (r > 0) { const e = n.stakeTime.toNumber(), i = n.unlockTime.toNumber(), s = (Date.now() / 1e3 - e) / 86400, l = r * t.apy / 100 / 365 * s; o += r, a += l, d.push({ pool: t.name, poolId: t.id, amount: r, rewards: l, apy: t.apy, lockDays: t.days, stakeTime: e, unlockTime: i }) } document.getElementById(`staked${t.id + 1}`).textContent = `${r.toFixed(2)} AETH`, document.getElementById(`staked${t.id + 1}Value`).textContent = `$${(r * aethPrice).toFixed(2)}` } catch (e) { console.log(`No stake in pool ${t.id}`, e), document.getElementById(`staked${t.id + 1}`).textContent = "0 AETH", document.getElementById(`staked${t.id + 1}Value`).textContent = "$0.00", document.getElementById(`staked${t.id + 1}Percentage`).textContent = "0%" } const i = n + o, s = i * aethPrice; if (document.getElementById("totalValue").textContent = `$${s.toFixed(2)}`, document.getElementById("totalChange").textContent = `+${a.toFixed(4)} AETH earned`, document.getElementById("totalAETH").textContent = `${i.toFixed(2)} AETH`, document.getElementById("aethUSD").textContent = `$${(i * aethPrice).toFixed(2)}`, document.getElementById("stakedAETH").textContent = `${o.toFixed(2)} AETH`, document.getElementById("stakedUSD").textContent = `$${(o * aethPrice).toFixed(2)}`, document.getElementById("totalRewards").textContent = `${a.toFixed(4)} AETH`, document.getElementById("rewardsUSD").textContent = `$${(a * aethPrice).toFixed(4)}`, document.getElementById("walletBalance").textContent = `${n.toFixed(2)} AETH`, document.getElementById("walletValue").textContent = `$${(n * aethPrice).toFixed(2)}`, document.getElementById("walletPercentage").textContent = `${i > 0 ? (n / i * 100).toFixed(1) : 0}%`, r.forEach((t, e) => { const n = document.getElementById(`staked${e + 1}`).textContent, o = parseFloat(n.replace(" AETH", "")), a = i > 0 ? (o / i * 100).toFixed(1) : 0; document.getElementById(`staked${e + 1}Percentage`).textContent = `${a}%` }), updateStakingTable(d), o > 0) { const t = d.length > 0 ? d.reduce((t, e) => t + e.amount / o * e.apy, 0) : 0; document.getElementById("avgAPY").textContent = `${t.toFixed(2)}%`; const e = o * t / 100 / 365; document.getElementById("dailyEarnings").textContent = `${e.toFixed(4)} AETH`, document.getElementById("monthlyEarnings").textContent = `${(30 * e).toFixed(2)} AETH`, document.getElementById("yearlyEarnings").textContent = `${(365 * e).toFixed(2)} AETH`; const n = o > 0 ? a / o * 100 : 0; document.getElementById("roi").textContent = `${n.toFixed(2)}%`; const r = d.length > 0 ? Math.floor(d.reduce((t, e) => t + (Date.now() / 1e3 - e.stakeTime) / 86400, 0) / d.length) : 0; document.getElementById("daysStaking").textContent = r } else document.getElementById("avgAPY").textContent = "0%", document.getElementById("dailyEarnings").textContent = "0 AETH", document.getElementById("monthlyEarnings").textContent = "0 AETH", document.getElementById("yearlyEarnings").textContent = "0 AETH", document.getElementById("roi").textContent = "0%", document.getElementById("daysStaking").textContent = "0" } catch (t) { console.error("Error loading portfolio data:", t), alert("Failed to load portfolio data. Some features may not work correctly.") } } function updateStakingTable(t) { const e = document.getElementById("stakesTableBody"); e.innerHTML = "", 0 !== t.length ? t.forEach(t => { new Date(1e3 * t.stakeTime); const n = new Date(1e3 * t.unlockTime), o = Date.now(), a = o < n.getTime(), d = Math.max(0, Math.ceil((n.getTime() - o) / 864e5)), r = t.amount * t.apy / 100, i = document.createElement("tr"); i.innerHTML = `\n                    <td><strong>${t.pool}</strong></td>\n                    <td>${t.amount.toFixed(2)} AETH</td>\n                    <td><span class="badge badge-success">${t.apy}%</span></td>\n                    <td>${t.rewards.toFixed(4)} AETH</td>\n                    <td>${r.toFixed(2)} AETH/yr</td>\n                    <td>${t.lockDays} days</td>\n                    <td>${n.toLocaleDateString()}</td>\n                    <td>\n                        ${a ? `<span class="badge badge-warning"><i class="fas fa-lock"></i> Locked (${d}d)</span>` : '<span class="badge badge-success"><i class="fas fa-unlock"></i> Unlocked</span>'}\n                    </td>\n                `, e.appendChild(i) }) : e.innerHTML = '<tr>\n                    <td colspan="8" class="empty-state">\n                        <i class="fas fa-inbox empty-state-icon"></i>\n                        No active staking positions\n                    </td>\n                </tr>' } window.addEventListener("load", async () => { if (window.ethereum) { const t = await window.ethereum.request({ method: "eth_accounts" }); t.length > 0 && (userAddress = t[0], provider = new ethers.providers.Web3Provider(window.ethereum), signer = provider.getSigner(), tokenContract = new ethers.Contract(TOKEN_ADDRESS, TOKEN_ABI, provider), stakingContract = new ethers.Contract(STAKING_ADDRESS, STAKING_ABI, provider), document.getElementById("walletStatus").style.display = "none", document.getElementById("portfolioContent").style.display = "block", await loadPortfolioData()) } }), setInterval(() => { userAddress && loadPortfolioData() }, 3e4)</script>
  <script src="global-announcements.js"></script>
</body>

</html>